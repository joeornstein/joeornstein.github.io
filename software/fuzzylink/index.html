<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Probabilistic Record Linkage Using Pretrained Text Embeddings • fuzzylink</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Probabilistic Record Linkage Using Pretrained Text Embeddings">
<meta name="description" content='Links datasets through fuzzy string matching using pretrained text embeddings. Produces more accurate record linkage when lexical string distance metrics are a poor guide to match quality (e.g., "Patricia" is more lexically similar to "Patrick" than it is to "Trish"). Capable of performing multilingual record linkage. Methods are described in Ornstein (2025) &lt;doi:10.1017/pan.2025.10016&gt;.'>
<meta property="og:description" content='Links datasets through fuzzy string matching using pretrained text embeddings. Produces more accurate record linkage when lexical string distance metrics are a poor guide to match quality (e.g., "Patricia" is more lexically similar to "Patrick" than it is to "Trish"). Capable of performing multilingual record linkage. Methods are described in Ornstein (2025) &lt;doi:10.1017/pan.2025.10016&gt;.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fuzzylink</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joeornstein/fuzzylink/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="fuzzylink">fuzzylink<a class="anchor" aria-label="anchor" href="#fuzzylink"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The R package <code>fuzzylink</code> implements a probabilistic record linkage procedure proposed in <a href="https://doi.org/10.1017/pan.2025.10016" class="external-link">Ornstein (2025)</a>. This method allows users to merge datasets with fuzzy matches on a key identifying variable. Suppose, for example, you have the following two datasets:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfA</span></span>
<span><span class="co">#&gt;             name age</span></span>
<span><span class="co">#&gt; 1      Joe Biden  81</span></span>
<span><span class="co">#&gt; 2   Donald Trump  77</span></span>
<span><span class="co">#&gt; 3   Barack Obama  62</span></span>
<span><span class="co">#&gt; 4 George W. Bush  77</span></span>
<span><span class="co">#&gt; 5   Bill Clinton  77</span></span>
<span><span class="va">dfB</span></span>
<span><span class="co">#&gt;                         name</span></span>
<span><span class="co">#&gt; 1     Joseph Robinette Biden</span></span>
<span><span class="co">#&gt; 2         Donald John Trump </span></span>
<span><span class="co">#&gt; 3       Barack Hussein Obama</span></span>
<span><span class="co">#&gt; 4         George Walker Bush</span></span>
<span><span class="co">#&gt; 5  William Jefferson Clinton</span></span>
<span><span class="co">#&gt; 6 George Herbert Walker Bush</span></span>
<span><span class="co">#&gt; 7                Biff Tannen</span></span>
<span><span class="co">#&gt; 8                  Joe Riley</span></span>
<span><span class="co">#&gt;        hobby</span></span>
<span><span class="co">#&gt; 1   Football</span></span>
<span><span class="co">#&gt; 2       Golf</span></span>
<span><span class="co">#&gt; 3 Basketball</span></span>
<span><span class="co">#&gt; 4    Reading</span></span>
<span><span class="co">#&gt; 5  Saxophone</span></span>
<span><span class="co">#&gt; 6  Skydiving</span></span>
<span><span class="co">#&gt; 7   Bullying</span></span>
<span><span class="co">#&gt; 8    Jogging</span></span></code></pre></div>
<p>We would like a procedure that correctly identifies which records in <code>dfB</code> are likely matches for each record in <code>dfA</code>. The <code><a href="reference/fuzzylink.html">fuzzylink()</a></code> function performs this record linkage with a single line of code.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(fuzzylink)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">fuzzylink</span>(dfA, dfB, <span class="at">by =</span> <span class="st">'name'</span>, <span class="at">record_type =</span> <span class="st">'person'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>df</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;                A</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 1      Joe Biden</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 2   Donald Trump</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 3   Barack Obama</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 4 George W. Bush</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 5   Bill Clinton</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;                           B</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; 1    Joseph Robinette Biden</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; 2        Donald John Trump </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; 3      Barack Hussein Obama</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; 4        George Walker Bush</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; 5 William Jefferson Clinton</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;         sim        jw match</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; 1 0.7661285 0.7673401   Yes</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; 2 0.8388663 0.9333333   Yes</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; 3 0.8457284 0.9200000   Yes</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; 4 0.8445312 0.9301587   Yes</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; 5 0.8730800 0.5788889   Yes</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;   match_probability age      hobby</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; 1                 1  81   Football</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; 2                 1  77       Golf</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; 3                 1  62 Basketball</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; 4                 1  77    Reading</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; 5                 1  77  Saxophone</span></span></code></pre></div>
<p>The procedure works by using <em>pretrained text embeddings</em> to construct a measure of similarity for each pair of names. These similarity measures are then used as predictors in a statistical model to estimate the probability that two name pairs represent the same entity. See <a href="https://doi.org/10.1017/pan.2025.10016" class="external-link">Ornstein (2025)</a> for technical details.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>fuzzylink</code> from CRAN with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'fuzzylink'</span><span class="op">)</span></span></code></pre></div>
<p>Or you can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"joeornstein/fuzzylink"</span><span class="op">)</span></span></code></pre></div>
<p>You will also need API access to a large language model (LLM). The <code>fuzzylink</code> package currently supports OpenAI, Mistral, and Anthropic Claude LLMs, but will default to using OpenAI unless specified by the user.</p>
<div class="section level3">
<h3 id="openai">OpenAI<a class="anchor" aria-label="anchor" href="#openai"></a>
</h3>
<p>Sign up for a developer account with OpenAI, then create an API key through your profile. For best performance, I <strong>strongly recommend</strong> purchasing at least $5 in API credits, which will significantly increase your API rate limits.</p>
<p>Once your account is created, copy-paste your API key into the following line of R code.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(fuzzylink)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">openai_api_key</span>(<span class="st">'YOUR API KEY GOES HERE'</span>, <span class="at">install =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mistral">Mistral<a class="anchor" aria-label="anchor" href="#mistral"></a>
</h3>
<p>If you prefer to use language models from Mistral, you can sign up for an account <a href="https://mistral.ai/" class="external-link">here</a>. As of writing, Mistral requires you to purchase prepaid credits before you can access their language models through the API.</p>
<p>Once you have a paid account, you can create an API key <a href="https://console.mistral.ai/api-keys/" class="external-link">here</a>, and copy-paste the API key into the following line of R code:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(fuzzylink)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">mistral_api_key</span>(<span class="st">'YOUR API KEY GOES HERE'</span>, <span class="at">install =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="anthropic">Anthropic<a class="anchor" aria-label="anchor" href="#anthropic"></a>
</h3>
<p>If you prefer to use Anthropic’s Claude models, you can sign up for an account <a href="https://www.anthropic.com/" class="external-link">here</a>. Once you have an API key, copy-paste it into the following line of R code:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(fuzzylink)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">anthropic_api_key</span>(<span class="st">'YOUR API KEY GOES HERE'</span>, <span class="at">install =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Now you’re all set up!</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Here is some code to reproduce the example above and make sure that everything is working on your computer.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joeornstein/fuzzylink" class="external-link">fuzzylink</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, <span class="op">~</span><span class="va">age</span>,</span>
<span>               <span class="st">'Joe Biden'</span>, <span class="fl">81</span>,</span>
<span>               <span class="st">'Donald Trump'</span>, <span class="fl">77</span>,</span>
<span>               <span class="st">'Barack Obama'</span>, <span class="fl">62</span>,</span>
<span>               <span class="st">'George W. Bush'</span>, <span class="fl">77</span>,</span>
<span>               <span class="st">'Bill Clinton'</span>, <span class="fl">77</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, <span class="op">~</span><span class="va">hobby</span>,</span>
<span>               <span class="st">'Joseph Robinette Biden'</span>, <span class="st">'Football'</span>,</span>
<span>               <span class="st">'Donald John Trump '</span>, <span class="st">'Golf'</span>,</span>
<span>               <span class="st">'Barack Hussein Obama'</span>, <span class="st">'Basketball'</span>,</span>
<span>               <span class="st">'George Walker Bush'</span>, <span class="st">'Reading'</span>,</span>
<span>               <span class="st">'William Jefferson Clinton'</span>, <span class="st">'Saxophone'</span>,</span>
<span>               <span class="st">'George Herbert Walker Bush'</span>, <span class="st">'Skydiving'</span>,</span>
<span>               <span class="st">'Biff Tannen'</span>, <span class="st">'Bullying'</span>,</span>
<span>               <span class="st">'Joe Riley'</span>, <span class="st">'Jogging'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fuzzylink.html">fuzzylink</a></span><span class="op">(</span><span class="va">dfA</span>, <span class="va">dfB</span>, by <span class="op">=</span> <span class="st">'name'</span>, record_type <span class="op">=</span> <span class="st">'person'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span></code></pre></div>
<p>If the <code>df</code> object links all the presidents to their correct name in <code>dfB</code>, everything is running smoothly! (Note that you may see a warning from <code>glm.fit</code>. This is normal. The <code>stats</code> package gets suspicious whenever the model fit is <em>too</em> perfect.)</p>
<div class="section level3">
<h3 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h3>
<ul>
<li><p>The <code>by</code> argument specifies the name of the fuzzy matching variable that you want to use to link records. The dataframes <code>dfA</code> and <code>dfB</code> must both have a column with this name.</p></li>
<li><p>The <code>record_type</code> argument should be a singular noun describing the type of entity the <code>by</code> variable represents (e.g. “person”, “organization”, “interest group”, “city”). It is used as part of a language model prompt when training the statistical model.</p></li>
<li><p>The <code>instructions</code> argument should be a string containing additional instructions to include in the language model prompt. Format these like you would format instructions to a human research assistant, including any relevant information that you think would help the model make accurate classifications.</p></li>
<li><p>The <code>model</code> argument specifies which language model to prompt. It defaults to OpenAI’s <code>'gpt-5.2'</code>, but also accepts Mistral models (e.g. <code>'mistral-large-latest'</code>) and Anthropic Claude models (e.g. <code>'claude-sonnet-4-5-20250929'</code>). For simpler problems, you can try <code>'gpt-3.5-turbo-instruct'</code>, which will significantly reduce cost and runtime.</p></li>
<li><p>The <code>embedding_model</code> argument specifies which pretrained text embeddings to use when modeling match probability. It defaults to OpenAI’s ‘text-embedding-3-large’, but will also accept ‘text-embedding-3-small’ or Mistral’s ‘mistral-embed’.</p></li>
<li><p>Several parameters—including <code>p</code>, <code>k</code>, <code>embedding_dimensions</code>, <code>max_validations</code>, and <code>parallel</code>—are for advanced users who wish to customize the behavior of the algorithm. See the package documentation for more details.</p></li>
<li><p>If there are any variables that must match <em>exactly</em> in order to link two records, you will want to include them in the <code>blocking.variables</code> argument. As a practical matter, I <strong>strongly recommend</strong> including blocking variables wherever possible, as they reduce the time and cost necessary to compute pairwise distance metrics. Suppose, for example, that our two illustrative datasets have a column called <code>state</code>, and we want to instruct <code><a href="reference/fuzzylink.html">fuzzylink()</a></code> to only link people who live within the same state.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, <span class="op">~</span><span class="va">state</span>, <span class="op">~</span><span class="va">age</span>,</span>
<span>               <span class="st">'Joe Biden'</span>, <span class="st">'Delaware'</span>, <span class="fl">81</span>,</span>
<span>               <span class="st">'Donald Trump'</span>, <span class="st">'New York'</span>, <span class="fl">77</span>,</span>
<span>               <span class="st">'Barack Obama'</span>, <span class="st">'Illinois'</span>, <span class="fl">62</span>,</span>
<span>               <span class="st">'George W. Bush'</span>, <span class="st">'Texas'</span>, <span class="fl">77</span>,</span>
<span>               <span class="st">'Bill Clinton'</span>, <span class="st">'Arkansas'</span>, <span class="fl">77</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, <span class="op">~</span><span class="va">state</span>, <span class="op">~</span><span class="va">hobby</span>,</span>
<span>               <span class="st">'Joseph Robinette Biden'</span>, <span class="st">'Delaware'</span>, <span class="st">'Football'</span>,</span>
<span>               <span class="st">'Donald John Trump '</span>, <span class="st">'Florida'</span>, <span class="st">'Golf'</span>,</span>
<span>               <span class="st">'Barack Hussein Obama'</span>, <span class="st">'Illinois'</span>, <span class="st">'Basketball'</span>,</span>
<span>               <span class="st">'George Walker Bush'</span>, <span class="st">'Texas'</span>, <span class="st">'Reading'</span>,</span>
<span>               <span class="st">'William Jefferson Clinton'</span>, <span class="st">'Arkansas'</span>, <span class="st">'Saxophone'</span>,</span>
<span>               <span class="st">'George Herbert Walker Bush'</span>, <span class="st">'Texas'</span>, <span class="st">'Skydiving'</span>,</span>
<span>               <span class="st">'Biff Tannen'</span>, <span class="st">'California'</span>, <span class="st">'Bullying'</span>,</span>
<span>               <span class="st">'Joe Riley'</span>, <span class="st">'South Carolina'</span>, <span class="st">'Jogging'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fuzzylink.html">fuzzylink</a></span><span class="op">(</span><span class="va">dfA</span>, <span class="va">dfB</span>, </span>
<span>                by <span class="op">=</span> <span class="st">'name'</span>,</span>
<span>                blocking.variables <span class="op">=</span> <span class="st">'state'</span>,</span>
<span>                record_type <span class="op">=</span> <span class="st">'person'</span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#&gt;                A</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; 1      Joe Biden</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; 2   Barack Obama</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 3 George W. Bush</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 4   Bill Clinton</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 5   Donald Trump</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;                           B</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 1    Joseph Robinette Biden</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 2      Barack Hussein Obama</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; 3        George Walker Bush</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; 4 William Jefferson Clinton</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; 5                      &lt;NA&gt;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;         sim block        jw match</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; 1 0.7661773     1 0.7673401   Yes</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; 2 0.8457001     3 0.9200000   Yes</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; 3 0.8446921     4 0.9301587   Yes</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; 4 0.8732265     5 0.5788889   Yes</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; 5        NA    NA        NA  &lt;NA&gt;</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;   match_probability    state age</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; 1                 1 Delaware  81</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; 2                 1 Illinois  62</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; 3                 1    Texas  77</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 4                 1 Arkansas  77</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; 5                NA New York  77</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt;        hobby</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; 1   Football</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; 2 Basketball</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; 3    Reading</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; 4  Saxophone</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; 5       &lt;NA&gt;</span></span></code></pre></div>
<p>Note that because Donald Trump is listed under two different states—New York in <code>dfA</code> and Florida in <code>dfB</code>–the <code><a href="reference/fuzzylink.html">fuzzylink()</a></code> function no longer returns a match for this record; all blocking variables must match exactly before the function will link two records together. You can specify as many blocking variables as needed by inputting their column names as a vector.</p>
<p>The function returns a few additional columns along with the merged dataframe. The column <code>match_probability</code> reports the model’s estimated probability that the pair of records refer to the same entity. This column should be used to aid in validation and can be used for computing weighted averages if a record in <code>dfA</code> is matched to multiple records in <code>dFB</code>. The columns <code>sim</code> and <code>jw</code> are string distance measures that the model uses to predict whether two records are a match. And if you included <code>blocking.variables</code> in the function call, there will be a column called <code>block</code> with an ID variable denoting which block the records belong to.</p>
</div>
</div>
<div class="section level2">
<h2 id="a-note-on-cost">A Note On Cost<a class="anchor" aria-label="anchor" href="#a-note-on-cost"></a>
</h2>
<p>Because the <code><a href="reference/fuzzylink.html">fuzzylink()</a></code> function makes several calls to the OpenAI API—which charges a per-token fee—there is a monetary cost associated with each use. Based on the package defaults and API pricing as of February 2026, here is a table of approximate costs for merging datasets of various sizes.</p>
<table class="table">
<thead><tr>
<th align="left">dfA</th>
<th align="left">dfB</th>
<th align="left">Approximate Cost (Default Settings)</th>
</tr></thead>
<tbody>
<tr>
<td align="left">10</td>
<td align="left">10</td>
<td align="left">$0</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">100</td>
<td align="left">$0</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">1,000</td>
<td align="left">$0</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">10,000</td>
<td align="left">$0.01</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">100,000</td>
<td align="left">$0.06</td>
</tr>
<tr>
<td align="left">10</td>
<td align="left">1,000,000</td>
<td align="left">$0.59</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">10</td>
<td align="left">$0.03</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">100</td>
<td align="left">$0.03</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">1,000</td>
<td align="left">$0.03</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">10,000</td>
<td align="left">$0.03</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">100,000</td>
<td align="left">$0.08</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">1,000,000</td>
<td align="left">$0.61</td>
</tr>
<tr>
<td align="left">1,000</td>
<td align="left">10</td>
<td align="left">$0.26</td>
</tr>
<tr>
<td align="left">1,000</td>
<td align="left">100</td>
<td align="left">$0.26</td>
</tr>
<tr>
<td align="left">1,000</td>
<td align="left">1,000</td>
<td align="left">$0.26</td>
</tr>
<tr>
<td align="left">1,000</td>
<td align="left">10,000</td>
<td align="left">$0.27</td>
</tr>
<tr>
<td align="left">1,000</td>
<td align="left">100,000</td>
<td align="left">$0.32</td>
</tr>
<tr>
<td align="left">1,000</td>
<td align="left">1,000,000</td>
<td align="left">$0.85</td>
</tr>
<tr>
<td align="left">10,000</td>
<td align="left">10</td>
<td align="left">$0.53</td>
</tr>
<tr>
<td align="left">10,000</td>
<td align="left">100</td>
<td align="left">$0.53</td>
</tr>
<tr>
<td align="left">10,000</td>
<td align="left">1,000</td>
<td align="left">$0.53</td>
</tr>
<tr>
<td align="left">10,000</td>
<td align="left">10,000</td>
<td align="left">$0.54</td>
</tr>
<tr>
<td align="left">10,000</td>
<td align="left">100,000</td>
<td align="left">$0.59</td>
</tr>
<tr>
<td align="left">10,000</td>
<td align="left">1,000,000</td>
<td align="left">$1.12</td>
</tr>
<tr>
<td align="left">100,000</td>
<td align="left">10</td>
<td align="left">$0.58</td>
</tr>
<tr>
<td align="left">100,000</td>
<td align="left">100</td>
<td align="left">$0.58</td>
</tr>
<tr>
<td align="left">100,000</td>
<td align="left">1,000</td>
<td align="left">$0.58</td>
</tr>
<tr>
<td align="left">100,000</td>
<td align="left">10,000</td>
<td align="left">$0.59</td>
</tr>
<tr>
<td align="left">100,000</td>
<td align="left">100,000</td>
<td align="left">$0.64</td>
</tr>
<tr>
<td align="left">100,000</td>
<td align="left">1,000,000</td>
<td align="left">$1.17</td>
</tr>
<tr>
<td align="left">1,000,000</td>
<td align="left">10</td>
<td align="left">$1.11</td>
</tr>
<tr>
<td align="left">1,000,000</td>
<td align="left">100</td>
<td align="left">$1.11</td>
</tr>
<tr>
<td align="left">1,000,000</td>
<td align="left">1,000</td>
<td align="left">$1.11</td>
</tr>
<tr>
<td align="left">1,000,000</td>
<td align="left">10,000</td>
<td align="left">$1.12</td>
</tr>
<tr>
<td align="left">1,000,000</td>
<td align="left">100,000</td>
<td align="left">$1.17</td>
</tr>
<tr>
<td align="left">1,000,000</td>
<td align="left">1,000,000</td>
<td align="left">$1.69</td>
</tr>
</tbody>
</table>
<p>Note that cost scales more quickly with the size of <code>dfA</code> than with <code>dfB</code>, because it is more costly to complete LLM prompts for validation than it is to retrieve embeddings. With particularly large datasets, one can reduce costs by using GPT-3.5 (<code>model = 'gpt-3.5-turbo-instruct'</code>), blocking (<code>blocking.variables</code>), or reducing the maximum number of pairs labeled by the LLM (<code>max_labels</code>).</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fuzzylink" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/joeornstein/fuzzylink/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/joeornstein/fuzzylink/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fuzzylink</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Joe Ornstein <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-5704-2098" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joe Ornstein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
